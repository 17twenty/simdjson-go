package simdjson

import (
	"fmt"
	_ "fmt"
	"testing"
)

func TestFindNewlineDelimiters(t *testing.T) {

	want := []uint64{
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000000000010000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000001000000000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
		0b0000000000000000000000000000000000000000000000000000000000000000,
	}

	for offset := 0; offset < len(demo_ndjson) - 64; offset += 64 {
		mask := _find_newline_delimiters([]byte(demo_ndjson)[offset:])
		fmt.Printf("%064b\n", mask)
		if mask != want[offset >> 6] {
			t.Errorf("TestFindNewlineDelimiters: got: %064b want: %064b", mask, want[offset >> 6])
		}
	}
}
